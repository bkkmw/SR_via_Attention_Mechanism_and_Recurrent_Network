# Attentive Recurrent Network

Attentive Recurrent ~~Generative Adversarial~~ Network for Shadow detection and removal

---

## ğŸ“† 2021.01 ~ 2021.08

---

## ğŸ“Abstract

Shadows presenting in most images are an obstacle to various deep learning based image processing tasks. Shadows in image are generated by the complex interaction of various light sources and various objects, and performance of various Computer Vision tasks can be improved by removing them. In this paper, we implement a network that detects shadows from image, removes shadows via attention mechanism, and handle complex shadows gradually by performing tasks in recurrent manner. Experiment was conducted on efficiently delivering data from previous step to next step.

### ğŸ‡°ğŸ‡·

ëŒ€ë¶€ë¶„ì˜ ì˜ìƒì— ì¡´ì¬í•˜ëŠ” ê·¸ë¦¼ìëŠ” ë‹¤ì–‘í•œ ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì˜ìƒì²˜ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•¨ì— ë°©í•´ê°€ ë˜ëŠ” ìš”ì†Œì´ë‹¤. ì˜ìƒ ë‚´ ê·¸ë¦¼ìëŠ” ë‹¤ì–‘í•œ ê´‘ì›ê³¼ ë‹¤ì–‘í•œ ë¬¼ì²´ë“¤ì˜ ìƒí˜¸ì‘ìš©ì— ì˜í•´ ë³µì¡í•˜ê²Œ ìƒì„±ë˜ë©° ì´ë¥¼ ì œê±°í•˜ëŠ” ê²ƒì„ í†µí•´ ë‹¤ì–‘í•œ Computer Vision taskì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì´ ë…¼ë¬¸ì—ì„œëŠ” ì˜ìƒ ë‚´ ê·¸ë¦¼ìë¥¼ ê°ì§€í•˜ì—¬ Attention mechanismì„ í†µí•´ ê·¸ë¦¼ìë¥¼ ì œê±°í•˜ê³  Recurrent í•˜ê²Œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©° ë³µì¡í•œ ê·¸ë¦¼ìë¥¼ ë‹¨ê³„ì ìœ¼ë¡œ ì œê±°í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬í˜„í•˜ì˜€ìœ¼ë©°, Recurrent í•œ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì´ì „ ë‹¨ê³„ì˜ ë°ì´í„°ë¥¼ ë‹¤ìŒ ë‹¨ê³„ì— íš¨ìœ¨ì ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì— ëŒ€í•œ ì‹¤í—˜ì„ ìˆ˜í–‰í•˜ì˜€ë‹¤

---

## ğŸ—ºï¸ Network Structure

Shadows in images are generated by various interactions between light sources and objects. It is hard for network to handle shadows in complex scenes at once.
So we adopted `Attention Mechanism` to efficiently handle shadow and `Recurrent Network` to gradually handle complex shadow.

### Overall Structure

![overall structure](/image/overall_structure.png)

### Shadow Detector

![shadow detector](/image/shadow_detectors.png)

Implemented both `shadow detector` (`LSTM(left)` and `Concat.(right)`), and compared performance of two network

### Removal Encoder

![removal encoder](/image/removal_encoder.png)

---

## ğŸ” Experiments

![experiment result](/image/experiments_result.png)

- compared to `LSTM detector` Network, `Concat. detector` Network shows slightly imporved performance at both `BER` and `RMSE` metric
- also can see that `Concat. detector` Network is removing shadow `Gradually`
  ![removal process](/image/removal_proc_result.png)

---

## ğŸ““ Conclusion

- `LSTM detector` Network cannot gradually work due to high dependency to previous step

  ![LSTM result](/image/result_lstm.png)

- `Concat. detector` Network can reduce dependency to previous step, thus can gradually handle shadows in image.

  ![Concat. result](/image/result_concat.png)
